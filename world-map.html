<!DOCTYPE html>
<html>
<head>
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
      background-color: #ffffff;
    }
    
    .container {
      max-width: 1200px;
      margin: 40px auto;
      position: relative;
      padding: 30px;
      border-radius: 10px;
      background-color: #f0f5f9;
    }
    
    .header {
      margin-bottom: 20px;
    }
    
    .header h1 {
      font-size: 32px;
      font-weight: 600;
      color: #1a2d40;
      margin: 0 0 8px 0;
    }
    
    .header p {
      font-size: 16px;
      color: #4a5568;
      margin: 0;
    }
    
    .map-wrapper {
      position: relative;
      margin-top: 20px;
    }
    
    svg {
      width: 100%;
      height: auto;
    }
    
    .dot {
      fill: #c0c5ce;
      r: 1.5;
    }
    
    .dot:hover {
      cursor: pointer;
    }
    
    .country-group:hover .dot {
      fill: #4671c6;
    }
    
    .country-tooltip {
      position: absolute;
      padding: 12px 16px;
      background: white;
      border-radius: 6px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.3s, transform 0.3s;
      transform: translateY(10px);
      z-index: 10;
      min-width: 150px;
      display: flex;
      align-items: center;
      gap: 10px;
      border: 1px solid #eaeaea;
    }
    
    .country-tooltip.visible {
      opacity: 1;
      transform: translateY(0);
    }
    
    .country-tooltip img {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      overflow: hidden;
    }
    
    .country-tooltip .country-name {
      font-weight: 500;
      color: #1a2d40;
    }
    
    .country-tooltip .country-stat {
      font-size: 14px;
      color: #4a5568;
      margin-top: 2px;
    }
    
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      z-index: 100;
      opacity: 0;
      transition: opacity 0.3s;
    }
    
    .modal.visible {
      opacity: 1;
    }
    
    .modal-content {
      position: relative;
      background-color: white;
      width: 90%;
      max-width: 550px;
      margin: 80px auto;
      padding: 30px;
      border-radius: 8px;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
      transform: translateY(20px);
      transition: transform 0.3s;
    }
    
    .modal.visible .modal-content {
      transform: translateY(0);
    }
    
    .close-btn {
      position: absolute;
      right: 20px;
      top: 20px;
      font-size: 24px;
      cursor: pointer;
      width: 30px;
      height: 30px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      background: #f5f5f5;
      color: #666;
      transition: background 0.2s;
    }
    
    .close-btn:hover {
      background: #eeeeee;
      color: #333;
    }
    
    .country-info {
      margin-top: 5px;
    }
    
    .country-header {
      display: flex;
      align-items: center;
      margin-bottom: 25px;
      gap: 15px;
    }
    
    .country-header img {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      border: 1px solid #eaeaea;
    }
    
    .country-header h2 {
      margin: 0;
      font-size: 24px;
      font-weight: 600;
      color: #1a2d40;
    }
    
    .country-header .country-stat {
      font-size: 14px;
      color: #4a5568;
    }
    
    .info-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-top: 20px;
    }
    
    .info-item {
      padding: 16px;
      background-color: #f8f9fa;
      border-radius: 6px;
      transition: background-color 0.2s;
    }
    
    .info-item:hover {
      background-color: #f0f2f5;
    }
    
    .info-item h4 {
      margin: 0 0 8px 0;
      color: #4a5568;
      font-weight: 500;
      font-size: 14px;
    }
    
    .info-item p {
      margin: 0;
      font-weight: 600;
      color: #1a2d40;
      font-size: 16px;
    }

    .search-section {
      margin-top: 30px;
    }

    .search-section h3 {
      font-size: 16px;
      font-weight: 500;
      color: #1a2d40;
      margin: 0 0 12px 0;
    }

    .country-select {
      position: relative;
    }

    .select-container {
      position: relative;
      max-width: 300px;
    }

    .select-btn {
      display: flex;
      align-items: center;
      gap: 10px;
      background: white;
      border: 1px solid #dcdfe6;
      border-radius: 6px;
      padding: 12px 16px;
      width: 100%;
      cursor: pointer;
      font-size: 16px;
      color: #1a2d40;
      transition: border-color 0.2s;
    }

    .select-btn:hover {
      border-color: #b0b7c3;
    }

    .select-btn img {
      width: 20px;
      height: 20px;
      border-radius: 50%;
    }

    .select-btn .arrow {
      margin-left: auto;
      transition: transform 0.2s;
    }

    .select-btn .arrow.open {
      transform: rotate(180deg);
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>Coverage</h1>
      <p>Explore our map</p>
    </div>
    
    <div class="map-wrapper">
      <svg id="map" viewBox="0 0 1200 600" preserveAspectRatio="xMidYMid meet"></svg>
      <div class="country-tooltip" id="tooltip"></div>
    </div>
    
    <div class="search-section">
      <h3>Search</h3>
      <div class="select-container">
        <button class="select-btn" id="select-btn">
          <img id="selected-flag" src="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/flags/4x3/gb.svg" alt="Flag">
          <span id="selected-country">United Kingdom</span>
          <span class="arrow">▼</span>
        </button>
      </div>
    </div>
  </div>
  
  <div class="modal" id="modal">
    <div class="modal-content">
      <span class="close-btn" id="closeModal">×</span>
      <div class="country-info" id="countryInfo"></div>
    </div>
  </div>

  <script>
    // Country data - simplified version with just names and document counts
    const countryData = {
      'USA': {
        name: 'United States',
        documents: '12,000+ documents',
        flagUrl: 'https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/flags/4x3/us.svg'
      },
      'CAN': {
        name: 'Canada',
        documents: '4,700+ documents',
        flagUrl: 'https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/flags/4x3/ca.svg'
      },
      'MEX': {
        name: 'Mexico',
        documents: '3,200+ documents',
        flagUrl: 'https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/flags/4x3/mx.svg'
      },
      'BRA': {
        name: 'Brazil',
        documents: '4,100+ documents',
        flagUrl: 'https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/flags/4x3/br.svg'
      },
      'ARG': {
        name: 'Argentina',
        documents: '2,800+ documents',
        flagUrl: 'https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/flags/4x3/ar.svg'
      },
      'GBR': {
        name: 'United Kingdom',
        documents: '5,600+ documents',
        flagUrl: 'https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/flags/4x3/gb.svg'
      },
      'FRA': {
        name: 'France',
        documents: '4,800+ documents',
        flagUrl: 'https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/flags/4x3/fr.svg'
      },
      'DEU': {
        name: 'Germany',
        documents: '5,200+ documents',
        flagUrl: 'https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/flags/4x3/de.svg'
      },
      'ESP': {
        name: 'Spain',
        documents: '3,700+ documents',
        flagUrl: 'https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/flags/4x3/es.svg'
      },
      'ITA': {
        name: 'Italy',
        documents: '4,100+ documents',
        flagUrl: 'https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/flags/4x3/it.svg'
      },
      'RUS': {
        name: 'Russia',
        documents: '3,200+ documents',
        flagUrl: 'https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/flags/4x3/ru.svg'
      },
      'CHN': {
        name: 'China',
        documents: '4,700+ documents',
        flagUrl: 'https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/flags/4x3/cn.svg'
      },
      'IND': {
        name: 'India',
        documents: '3,900+ documents',
        flagUrl: 'https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/flags/4x3/in.svg'
      },
      'JPN': {
        name: 'Japan',
        documents: '3,500+ documents',
        flagUrl: 'https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/flags/4x3/jp.svg'
      },
      'AUS': {
        name: 'Australia',
        documents: '3,800+ documents',
        flagUrl: 'https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/flags/4x3/au.svg'
      },
      'ZAF': {
        name: 'South Africa',
        documents: '2,400+ documents',
        flagUrl: 'https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/flags/4x3/za.svg'
      },
      'NGA': {
        name: 'Nigeria',
        documents: '1,800+ documents',
        flagUrl: 'https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/flags/4x3/ng.svg'
      },
      'EGY': {
        name: 'Egypt',
        documents: '2,100+ documents',
        flagUrl: 'https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/flags/4x3/eg.svg'
      },
      'IDN': {
        name: 'Indonesia',
        documents: '2,600+ documents',
        flagUrl: 'https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/flags/4x3/id.svg'
      },
      'MDG': {
        name: 'Madagascar',
        documents: '800+ documents',
        flagUrl: 'https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/flags/4x3/mg.svg'
      },
      'CUB': {
        name: 'Cuba',
        documents: '950+ documents',
        flagUrl: 'https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/flags/4x3/cu.svg'
      },
      'ISL': {
        name: 'Iceland',
        documents: '720+ documents',
        flagUrl: 'https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/flags/4x3/is.svg'
      }
    };

    // Country path data - defining the shapes of each country
    const countryPaths = {
      'USA': 'M200,180 L230,180 L250,190 L300,200 L330,200 L340,210 L320,230 L280,240 L238,235 L210,230 L200,210 Z M170,170 L200,170 L220,180 L200,190 Z',
      'CAN': 'M170,150 L200,150 L240,150 L280,160 L330,160 L340,150 L330,140 L310,130 L290,120 L250,110 L210,120 L170,130 L150,140 Z',
      'MEX': 'M200,230 L230,230 L250,235 L260,250 L250,270 L220,270 L210,260 L200,240 Z',
      'GBR': 'M460,160 L465,150 L470,160 L465,170 L455,170 L450,160 Z',
      'FRA': 'M470,180 L480,175 L490,175 L495,185 L490,195 L480,200 L470,195 L465,185 Z',
      'DEU': 'M490,165 L500,160 L510,160 L515,170 L510,180 L500,180 L490,175 Z',
      'ITA': 'M490,190 L500,190 L505,200 L500,210 L495,220 L490,210 L485,195 Z M490,220 L500,220 L495,230 L485,230 Z',
      'ESP': 'M450,190 L480,190 L480,200 L470,210 L450,215 L440,210 L435,200 Z',
      'RUS': 'M520,140 L580,140 L620,130 L660,120 L700,120 L740,130 L780,150 L770,170 L720,180 L680,170 L640,160 L600,170 L560,160 L530,170 L520,160 Z',
      'CHN': 'M650,190 L680,180 L710,190 L730,200 L740,220 L730,240 L710,250 L690,240 L670,230 L660,220 L650,210 Z',
      'IND': 'M630,230 L650,220 L670,230 L675,250 L670,270 L650,290 L630,280 L620,260 L625,240 Z',
      'JPN': 'M780,180 L785,200 L780,220 L775,200 Z M790,190 L795,200 L790,210 Z',
      'AUS': 'M740,350 L770,350 L800,360 L820,380 L810,400 L780,400 L760,390 L750,370 Z',
      'BRA': 'M300,310 L330,310 L350,330 L360,360 L350,390 L330,410 L300,410 L280,390 L280,360 L290,330 Z',
      'ARG': 'M280,420 L300,420 L310,450 L300,480 L280,510 L270,500 L260,470 L270,440 Z',
      'ZAF': 'M500,370 L530,370 L530,390 L510,400 L500,390 L490,380 Z',
      'EGY': 'M520,220 L550,220 L550,240 L530,250 L520,240 Z',
      'NGA': 'M480,270 L505,270 L505,290 L480,290 Z',
      'IDN': 'M700,290 L740,290 L740,300 L700,300 Z M750,295 L770,295 L770,305 L750,305 Z M775,305 L795,305 L795,315 L775,315 Z M800,315 L820,315 L820,325 L800,325 Z',
      'MDG': 'M560,340 L570,330 L580,340 L580,360 L570,370 L560,360 Z',
      'CUB': 'M245,250 L270,250 L270,258 L245,258 Z',
      'ISL': 'M430,130 L445,130 L445,140 L430,140 Z'
    };

    const svg = document.getElementById('map');
    const tooltip = document.getElementById('tooltip');
    const modal = document.getElementById('modal');
    const closeModal = document.getElementById('closeModal');
    const countryInfo = document.getElementById('countryInfo');
    const selectBtn = document.getElementById('select-btn');
    
    // Create country groups and add dot matrix
    const dotSpacing = 4; // Distance between dots

    // First create all the country path elements
    for (const [code, path] of Object.entries(countryPaths)) {
      // Create a country group
      const group = document.createElementNS('http://www.w3.org/2000/svg', 'g');
      group.setAttribute('id', `country-${code}`);
      group.setAttribute('class', 'country-group');
      group.setAttribute('data-country', code);
      
      // Create the actual SVG path (invisible, used for hit detection)
      const pathElement = document.createElementNS('http://www.w3.org/2000/svg', 'path');
      pathElement.setAttribute('d', path);
      pathElement.setAttribute('fill', 'transparent');
      pathElement.setAttribute('pointer-events', 'all');
      group.appendChild(pathElement);
      
      // Add event listeners for interactivity
      group.addEventListener('mouseover', showTooltip);
      group.addEventListener('mousemove', moveTooltip);
      group.addEventListener('mouseout', hideTooltip);
      group.addEventListener('click', showCountryModal);
      
      svg.appendChild(group);
    }
    
    // Add the dot matrix
    // For each country, parse its path and place dots accordingly
    for (const [code, pathData] of Object.entries(countryPaths)) {
      const group = document.getElementById(`country-${code}`);
      const pathElement = group.querySelector('path');
      
      // Get the bounding box of the country path
      const bbox = getBoundingBox(pathData);
      
      // Create dots within the bounding box
      for (let x = bbox.minX; x <= bbox.maxX; x += dotSpacing) {
        for (let y = bbox.minY; y <= bbox.maxY; y += dotSpacing) {
          // Create a dot at this position
          const dot = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
          dot.setAttribute('cx', x);
          dot.setAttribute('cy', y);
          dot.setAttribute('class', 'dot');
          group.appendChild(dot);
        }
      }
    }
    
    // Helper function to get the bounding box of an SVG path
    function getBoundingBox(pathData) {
      // Extract all x,y coordinates from the path data
      const coords = [];
      const regex = /([ML]) (\d+),(\d+)/g;
      let match;
      
      while ((match = regex.exec(pathData)) !== null) {
        coords.push({
          x: parseInt(match[2]),
          y: parseInt(match[3])
        });
      }
      
      // Find min and max coordinates
      const xs = coords.map(c => c.x);
      const ys = coords.map(c => c.y);
      
      return {
        minX: Math.min(...xs),
        maxX: Math.max(...xs),
        minY: Math.min(...ys),
        maxY: Math.max(...ys)
      };
    }
    
    // Tooltip functions
    function showTooltip(e) {
      const countryCode = e.currentTarget.getAttribute('data-country');
      const country = countryData[countryCode];
      
      tooltip.innerHTML = `
        <img src="${country.flagUrl}" alt="${country.name} flag">
        <div>
          <div class="country-name">${country.name}</div>
          <div class="country-stat">${country.documents}</div>
        </div>
      `;
      
      tooltip.classList.add('visible');
      moveTooltip(e);
    }
    
    function moveTooltip(e) {
      const mapRect = svg.getBoundingClientRect();
      const x = e.clientX - mapRect.left;
      const y = e.clientY - mapRect.top;
      
      tooltip.style.left = `${x + 15}px`;
      tooltip.style.top = `${y + 15}px`;
    }
    
    function hideTooltip() {
      tooltip.classList.remove('visible');
    }
    
    // Modal functions
    function showCountryModal(e) {
      const countryCode = e.currentTarget.getAttribute('data-country');
      updateCountryInfo(countryCode);
      
      modal.style.display = 'block';
      setTimeout(() => {
        modal.classList.add('visible');
      }, 10);
    }
    
    function updateCountryInfo(countryCode) {
      const country = countryData[countryCode];
      
      countryInfo.innerHTML = `
        <div class="country-header">
          <img src="${country.flagUrl}" alt="${country.name} flag">
          <div>
            <h2>${country.name}</h2>
            <div class="country-stat">${country.documents}</div>
          </div>
        </div>
        <div class="info-grid">
          <div class="info-item">
            <h4>Documents</h4>
            <p>${country.documents}</p>
          </div>
        </div>
      `;
    }
    
    // Close modal events
    closeModal.addEventListener('click', closeCountryModal);
    modal.addEventListener('click', function(e) {
      if (e.target === modal) {
        closeCountryModal();
      }
    });
    
    function closeCountryModal() {
      modal.classList.remove('visible');
      setTimeout(() => {
        modal.style.display = 'none';
      }, 300);
    }
    
    // Select dropdown functionality
    selectBtn.addEventListener('click', function() {
      const arrow = this.querySelector('.arrow');
      arrow.classList.toggle('open');
      
      // This would normally toggle a dropdown with countries
      // For this demo we'll just select UK directly
      updateSelectedCountry('GBR');
    });
    
    function updateSelectedCountry(countryCode) {
      const country = countryData[countryCode];
      document.getElementById('selected-flag').src = country.flagUrl;
      document.getElementById('selected-country').textContent = country.name;
    }
    
    // Initialize with UK selected
    updateSelectedCountry('GBR');
  </script>
</body>
</html>
